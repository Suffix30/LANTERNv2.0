<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      width: 300px;
      padding: 15px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #1a1a2e;
      color: #eee;
    }
    h1 {
      font-size: 16px;
      margin: 0 0 10px 0;
      color: #00ff88;
    }
    .status {
      padding: 10px;
      background: #16213e;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .status.connected { border-left: 3px solid #00ff88; }
    .status.disconnected { border-left: 3px solid #ff6600; }
    .status.offline { border-left: 3px solid #888; }
    .tabs-info {
      font-size: 12px;
      color: #888;
      margin-bottom: 10px;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #00ff88;
      color: #000;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      margin-bottom: 8px;
    }
    button:hover {
      background: #00cc6a;
    }
    .note {
      font-size: 11px;
      color: #666;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Agent BLACK</h1>
  <div id="status" class="status offline">
    Standalone Mode (data saved locally)
  </div>
  <div class="tabs-info" id="tabs-info">Loading...</div>
  <button id="sync">Save Browser State</button>
  <button id="copy" style="background: #444; color: #fff;">Copy Tab URLs</button>
  <div class="note">Overwatch reads saved data automatically</div>

  <script>
    async function updateTabCount() {
      const tabsInfo = document.getElementById('tabs-info');
      try {
        const tabs = await chrome.tabs.query({});
        tabsInfo.textContent = `Tracking ${tabs.length} open tabs`;
      } catch (e) {
        tabsInfo.textContent = 'Unable to access tabs';
      }
    }
    
    document.getElementById('sync').addEventListener('click', async () => {
      const tabs = await chrome.tabs.query({});
      const state = {
        timestamp: new Date().toISOString(),
        tabs: tabs.map(t => ({ url: t.url, title: t.title, active: t.active })),
      };
      chrome.storage.local.set({ browserState: state });
      document.getElementById('status').textContent = `Saved ${tabs.length} tabs at ${new Date().toLocaleTimeString()}`;
    });
    
    document.getElementById('copy').addEventListener('click', async () => {
      const tabs = await chrome.tabs.query({});
      const urls = tabs.map(t => t.url).join('\n');
      navigator.clipboard.writeText(urls);
      document.getElementById('status').textContent = `Copied ${tabs.length} URLs to clipboard`;
    });
    
    updateTabCount();
  </script>
</body>
</html>
